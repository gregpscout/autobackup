*** Settings ***
Variables  ../../models/Requisition_Models.py

*** Keywords ***
User is on TBE Site  
  [Arguments]  ${Url}  ${Browser}  
	Open Browser  ${Url}  ${Browser}
	Maximize Browser Window
	TBE Login Page Should Be Open
	
Login to TBE
  [Arguments]  ${username}  ${password}  ${companyCode}
    Input Text  uname  ${username}
    Input Text  pword  ${password}
    Input Text  ccode  ${companyCode} 
    Click Button  Submit	
    
Go to Create Requisition Form in TBE
  [Documentation]  Takes the user to Create Requisition Form when logged in to TBE
    Mouse Down On Link  Requisitions 
    Wait Until Page Contains  New Requisition
    Wait Until Element is Visible  xpath=/html/body/div[4]/div/div/ul/li[2]/ul/li[2]/a
    Click Link  New Requisition	
    Mouse Up  xpath=/html/body/div[4]/div/div/ul/li[2]/a  
    
User is on Create Requisition Page for TBE
    Page Should Contain  Requisitions: New Requisition 
    
Create New Requisition in TBE  
  [Arguments]  ${tbeReq} 
    Go to Create Requisition Form in TBE
    User is on Create Requisition Page for TBE 
    Enter Job Details for TBE  ${tbeReq}
    
Enter Job Details for TBE  
  [Arguments]  ${tbeReq}    
    Input Text  openedDate  ${tbeReq['openDate']}
    Input Text  title  ${tbeReq['title']} 
    Select From List  location  ${tbeReq['location']}
    Select From List  jobCat  ${tbeReq['jobCat']}
    Select From List  status  ${tbeReq['status']}
    Input Text  numOpen  ${tbeReq['numOpen']}  
    Select From List  duration  ${tbeReq['duration']}
    Select Checkbox  ${tbeReq['postToScout']}
    Checkbox Should Be Selected  CUSTOM_950
    Select Frame  xpath=//iframe[contains(@class,'cke_wysiwyg_frame')]
    Input Text  xpath= //body[contains(@class,'cke_editable')]  ${tbeReq['description']} 
    Unselect Frame
    Click Button  update            
    	
Get Job Req Id
  [Arguments]  ${jobTitle}
  [Documentation]  Returns job id when searched by title on TBE  
    Go to Requisitions Page in TBE
    ${jobId}=  Search Job Requisition on TBE  ${jobTitle}
    [return]  ${jobId.strip()}
    
Go to Requisitions Page in TBE 
    Click Link  Requisitions 
    Verify User is on TBE Requisitions Page 
  
Search Job Requisition on TBE
  [Arguments]  ${jobTitle}
  [Documentation]  Returns job id on TBE when user is on Requisitions page
    Input Text  //*[@id="content"]/table/tbody/tr[1]/td/div/form/input[2]  ${jobTitle}
    Sleep  5S
    Click Button  //*[@id="content"]/table/tbody/tr[1]/td/div/form/input[3]
    Click Link  Last Updated
    Click Link  Last Updated
    Wait until Page Contains Element  REQUS_0 
    ${jobId}=  Get Table Cell  REQUS_0  2  3  
    [return]  ${jobId}
    
Delete Job from TBE  [Arguments]  ${jobId}
    Select Checkbox  ${jobId}
    Click Button  Delete    
 
Verify user is logged in to TBE
    Page Should Contain  My View:
	      
Verify User is on TBE Requisitions Page
    Page Should Contain  Requisitions: Home  
    Page Should Contain Element  keywords   
		
TBE Login Page Should Be Open
	Title Should Be  Log into Taleo Business Edition	
	
Go to Scout Candidates List for Job  
  [Arguments]  ${jobTitle}  ${env}
    Search Job Requisition on TBE  ${jobTitle}
    Click Link  ${jobTitle}
    Run keyword If  '${env}' == 'staging'  Verify User is on Job Details Page for Staging  ${jobTitle}
    Run keyword If  '${env}' == 'test'  Verify User is on Job Details Page for Test  ${jobTitle}
    Run keyword If  '${env}' == 'staging'  Click Link  \#a185
    Run keyword If  '${env}' == 'test'  Click Link  \#a233
    Verify User is on Scout Candidates Page for TBE  ${env}
    
Verify User is on Scout Candidates Page for TBE
  [Arguments]  ${env}
    Wait Until Keyword Succeeds  10  2  Page Should Contain  Scout for Taleo
    Select Frame in TBE  ${env}
    Wait Until Keyword Succeeds  10  2  Page Should Contain Link  xpath=//*[@class="faq"]
    Wait Until Keyword Succeeds  10  2  Page Should Contain Link  xpath=//*[@class="feedback-link"]      
    Unselect Frame

Share Candidate in TBE
  [Arguments]  ${CandidateName}  ${email}  ${env} 
    Go to Candidate Details Page from Scout Candidates List  ${CandidateName}  ${env} 
    Select Frame in TBE  ${env}  
    Click Element  share-candidate-button
    Wait Until Page Contains Element  share-modal
    Input Text  share-modal__to  ${email}
    Click Link  share-modal__send
    Verify User is on Candidate Details Page 
    Unselect Frame
    
Accept Candidate in TBE  
  [Arguments]  ${CandidateName}  ${jobTitle}  ${env}
    Verify User is on Candidate Details Page
    Select Frame in TBE  ${env}
    Click Element  interested 
    Wait Until Keyword Succeeds  10  2  Page Should Contain Element  interested-modal 
    Element Should Contain  interested-modal  Would you like to import ${CandidateName} to the ${jobTitle} requisition?
    Click Element  interested-modal__submit
    Unselect Frame
        
Reject Candidate in TBE  
  [Arguments]  ${CandidateName}  ${reason}  ${comments}  ${env}
    Go to Candidate Details Page from Scout Candidates List  ${CandidateName}  ${env}
    Select Frame in TBE  ${env}
    Click Element  not-interested
    Wait Until Keyword Succeeds  10  2  Page Should Contain Element  not-interested-modal
    Select Radio Button  not-interested-reason  ${reason}    
    Input Text  not-interested-modal__comments  ${comments}         
    Click Element  not-interested-modal__submit    
    Unselect Frame
    
Go to Candidate Details Page from Scout Candidates List
  [Arguments]  ${CandidateName}  ${env} 
    Select Frame in TBE  ${env}
    Wait Until Keyword Succeeds  10  2  Page Should Contain Element  xpath=//*[@class="candidateList"]
    Click Link  ${CandidateName} 
    Verify User is on Candidate Details Page 
    Unselect Frame      
    
Verify User is on Candidate Details Page
    Wait Until Keyword Succeeds  10  2  Page Should Contain  Candidate Profile     
    
Verify User is on Job Details Page for Staging  
  [Arguments]  ${jobTitle}
    Wait Until Keyword Succeeds  10  2  Element Should Contain  \#a28  Posting Information 
    Wait Until Keyword Succeeds  10  2  Element Should Contain  \#a185  Scout Candidates
	
Verify User is on Job Details Page for Test  
  [Arguments]  ${jobTitle}
    Wait Until Keyword Succeeds  10  2  Element Should Contain  \#a225  Posting Information 
    Wait Until Keyword Succeeds  10  2  Element Should Contain  \#a233  Scout Candidates

Select Frame in TBE
  [Arguments]  ${env}
    Select Frame  xpath=//iframe[contains(@src,'https://${env}.talentpx.com')]













