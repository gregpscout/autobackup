*** Keywords ***

Test Feedback Link on Scout  
  [Arguments]  ${feedback_input}  ${feedback_subject}  ${EMAIL_ID}  ${EMAIL_PWD}  ${NOREPLY_EMAIL}
    Click Link  xpath=//*[@class="feedback-link"]
    Wait Until Element is Visible  feedback-modal
    Input Text  feedback-modal__feedback-textarea  ${feedback_input}
    Click Button  feedback-modal__submit
    Wait Until Keyword Succeeds  120  5  Validate Email Received  ${feedback_input}  ${feedback_subject}  ${EMAIL_ID}  ${EMAIL_PWD}  ${NOREPLY_EMAIL}  ${SCOUT_QA_EMAIL}

Test Need Help with Scout Link   
  [Arguments]  ${needhelp_link}  ${needhelp_text}
    Click Link  xpath=//*[@class="faq"]
    Sleep  2s
    Select Window  title=${needhelp_link}
    Page Should Contain  ${needhelp_text}
    Close Window

Validate Email Received  
  [Arguments]  ${validate_input}  ${validate_subject}  ${EMAIL_ID}  ${EMAIL_PWD}  ${NOREPLY_EMAIL}  ${RECEIVER_EMAIL}
    Open Mailbox  server=imap.googlemail.com  user=${EMAIL_ID}  password=${EMAIL_PWD}   
    ${latest}=  Wait for mail  fromEmail=${NOREPLY_EMAIL}  toEmail=${RECEIVER_EMAIL}  timeout=150
    ${parts}=  Walk Multipart Email  ${latest}
    @{fields}=  Get Multipart Field Names
    ${subject}=  Get Multipart Field  Subject
    Should Contain  ${subject}   ${validate_subject}
    ${payload}=  Get Multipart Payload  decode=True
    ${content}=  Should Contain  ${payload}  ${validate_input}
    Close Mailbox